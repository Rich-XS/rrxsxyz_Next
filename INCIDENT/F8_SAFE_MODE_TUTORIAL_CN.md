# 🔧 Windows F8 安全模式操作教程（完全小白版）

## 📋 准备工作

在进入安全模式前，请确认：
- ✅ 关闭所有正在运行的程序（包括IDE、浏览器等）
- ✅ 清空剪贴板，不需要复制粘贴
- ✅ 大概需要10-15分钟
- ✅ 如果中途有问题，直接重启恢复到正常模式

---

## 🎯 完整操作步骤

### 第1步：进入安全模式

#### **方式A：通过关机菜单（推荐，最简单）**

1. **点击Windows开始菜单**
   - 左下角Windows图标，点一下

2. **找到"电源"**
   - 右下角有个圆形的"电源"按钮

3. **按住Shift键，然后点击"重启"**
   - 很重要：要按住Shift不松，再点"重启"
   - 如果没按住Shift，重启就是普通重启，不行

4. **选择疑难解答**
   - 蓝色屏幕出现，看到"选择一个选项"
   - 点击左下角 **"疑难解答"** 按钮

5. **点击"启动设置"**
   - 看到"重置此电脑"和"启动设置"两个选项
   - 点击 **"启动设置"**

6. **点击"重启"**
   - 弹出小窗口，点底部蓝色的 **"重启"** 按钮
   - 电脑会重启

#### **方式B：通过F8启动菜单（备选，重启时快速按F8）**

1. **关闭所有程序，点"开始" → "关机" → "重启"**

2. **重启时立即开始连续按F8键**
   - 重启后，在黑屏时快速反复按F8
   - 听到响声或看到菜单后停止按

3. **看到蓝色菜单，用↑↓方向键选择**
   - 找到 **"带网络连接的安全模式"** 或 **"安全模式"**
   - 按Enter进入

---

### 第2步：进入安全模式后，看到黑色屏幕

等待加载，会看到一个**黑色的桌面**，左上角写着"安全模式"。

这是**正常的**，说明成功了！

---

### 第3步：打开管理员PowerShell

1. **同时按Ctrl + Shift + Esc**
   - 打开"任务管理器"（黑色窗口）

2. **找到菜单栏，点击"文件"**
   - 左上角有个"文件"

3. **看到两个选项：**
   - ❌ "运行新任务"
   - ✅ "运行新任务（管理员）" ← **点这个！**

4. **输入 `powershell`**
   - 在弹出的小窗口里，下方有个输入框
   - 输入：`powershell`

5. **勾选"使用管理员账户"**
   - 下面有个勾选框，要打勾

6. **点OK**
   - 白色的PowerShell窗口打开了，说明成功

---

### 第4步：运行清理脚本

在PowerShell窗口中，复制下面这行命令，粘贴进去，按Enter：

```powershell
cd D:\_100W\rrxsxyz_next\scripts
.\safe_mode_cleanup.bat
```

**逐步说明：**

1. **第一行：`cd D:\_100W\rrxsxyz_next\scripts`**
   - 意思：进入脚本所在的文件夹
   - 复制整行，右键 → 粘贴，按Enter

2. **第二行：`.\safe_mode_cleanup.bat`**
   - 意思：运行清理脚本
   - 复制整行，右键 → 粘贴，按Enter

3. **脚本自动开始运行**
   - 会看到一个黑色窗口，显示清理进度
   - 等待完成（大约2-3分钟）
   - 完成后会提示"按任意键继续"

---

### 第5步：等待脚本运行

脚本会自动：
1. ✅ 删除OneDrive应用目录（LocalAppData）
2. ✅ 删除OneDrive程序文件（ProgramFiles）
3. ✅ 清理Windows注册表
4. ✅ 清理项目目录中的nul文件
5. ✅ 验证清理结果

**看到这些信息代表成功：**
- "LocalAppData OneDrive: 已删除 ✓"
- "ProgramFiles OneDrive: 已删除 ✓"
- "nul文件数: 0"

---

### 第6步：重启回到正常模式

脚本提示"按任意键继续"时：

1. **按任意键**（例如空格）
   - 窗口关闭

2. **点开始菜单 → 电源 → 重启**
   - 选择 **"重启"**（不需要按Shift）

3. **电脑重启**
   - 看到Windows登录界面，说明回到正常模式了

4. **输入密码登录**
   - 正常登录Windows

---

## ✅ 清理完成后的验证

重启回到正常模式后，打开PowerShell（或Windows Terminal）：

```powershell
Get-ChildItem -Path 'D:\_100W\rrxsxyz_next' -Recurse -Filter 'nul' | Measure-Object | Select-Object Count
```

**如果显示 `Count: 0`，说明成功！** ✓

---

## 🆘 如果出错了？

### 问题1：重启时没看到"疑难解答"屏幕

**解决：** 按住Shift不要松开，再点重启。如果还不行，直接重启（不按Shift），然后在重启时反复按F8。

### 问题2：进不了安全模式，一直重启

**解决：** 直接长按电源键10秒钟，强制关机，然后再开机，应该会进入自动修复，选择"继续使用Windows"。

### 问题3：安全模式中看不到脚本文件

**解决：**
```powershell
# 检查脚本是否存在
Test-Path D:\_100W\rrxsxyz_next\scripts\safe_mode_cleanup.bat

# 列出脚本目录
Get-ChildItem D:\_100W\rrxsxyz_next\scripts\
```

### 问题4：脚本提示"拒绝访问"

**解决：** 确保：
- ✅ 已经按照第3步用管理员身份打开PowerShell
- ✅ 已经按住Shift进入安全模式
- ✅ 如果还不行，直接用文件管理器手动删除文件夹

---

## 💡 手动清理方案（如果脚本失败）

如果脚本执行失败，可以手动删除：

1. **按Windows键 + E** 打开文件管理器
2. **地址栏输入：** `C:\Users\rrxs\AppData\Local\Microsoft`
3. **右键OneDrive文件夹 → 删除**
4. **地址栏输入：** `C:\Program Files`
5. **右键"Microsoft OneDrive" → 删除**
6. **重启电脑**

---

## 📝 总结

| 步骤 | 操作 |
|------|------|
| 1️⃣ | 开始菜单 → 电源 → 按住Shift + 重启 |
| 2️⃣ | 疑难解答 → 启动设置 → 重启 |
| 3️⃣ | 进入安全模式（黑屏，左上角写着"安全模式"） |
| 4️⃣ | Ctrl + Shift + Esc → 文件 → 运行新任务（管理员）→ powershell |
| 5️⃣ | 运行清理脚本 `.\safe_mode_cleanup.bat` |
| 6️⃣ | 等待完成，按任意键 |
| 7️⃣ | 重启回到正常模式 |
| 8️⃣ | 验证：nul文件应为0 |

---

**需要帮助？只需按照上面的步骤一步步来，慢不是问题。** ✅
