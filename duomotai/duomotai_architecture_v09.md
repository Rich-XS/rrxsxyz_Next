# å¤šé­”æ±° v9 æ¶æ„æ–‡æ¡£ - çœŸå®åŠ¨æ€å¯¹è¯ç³»ç»Ÿ

**ç‰ˆæœ¬**: v9.0
**åˆ›å»ºæ—¶é—´**: 2025-10-03 23:55
**æ ¸å¿ƒå®šä½**: ä»æµç¨‹åŒ–ç³»ç»Ÿå‡çº§ä¸º AI é©±åŠ¨çš„çœŸå®åŠ¨æ€å¯¹è¯ç³»ç»Ÿ

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒéœ€æ±‚ä¸è®¾è®¡ç†å¿µ](#1-æ ¸å¿ƒéœ€æ±‚ä¸è®¾è®¡ç†å¿µ)
2. [æ¶æ„è®¾è®¡](#2-æ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#3-æ ¸å¿ƒç»„ä»¶è¯¦è§£)
4. [å®ç°ç»†èŠ‚](#4-å®ç°ç»†èŠ‚)
5. [å¾…è®¨è®ºä¸ç¡®å®šçš„ç»†èŠ‚](#5-å¾…è®¨è®ºä¸ç¡®å®šçš„ç»†èŠ‚)
6. [æµ‹è¯•éªŒè¯è®¡åˆ’](#6-æµ‹è¯•éªŒè¯è®¡åˆ’)
7. [ä¸ v8 çš„å¯¹æ¯”](#7-ä¸-v8-çš„å¯¹æ¯”)

---

## 1. æ ¸å¿ƒéœ€æ±‚ä¸è®¾è®¡ç†å¿µ

### 1.1 ç”¨æˆ·æ ¸å¿ƒéœ€æ±‚ï¼ˆåŸè¯ï¼‰

> "å¯¹è¯çš„å»¶ç»­æ€§å’Œå®é™…ç°å®ç¬¦åˆæ€§æœ€é‡è¦ï¼Œè€Œä¸æ˜¯èµ°è¿‡åœº"

**å…³é”®è¯è§£æ**ï¼š
- **å»¶ç»­æ€§**ï¼šæ¯ä½ä¸“å®¶çš„å‘è¨€åº”è¯¥ä¸è‡ªå·±ä¹‹å‰çš„è§‚ç‚¹è¿è´¯ï¼Œå±•ç°æ€è€ƒçš„é€’è¿›
- **å®é™…ç°å®ç¬¦åˆæ€§**ï¼šæ¨¡æ‹ŸçœŸå®ä¼šè®®åœºæ™¯ï¼Œä¸“å®¶ä¹‹é—´æœ‰äº’åŠ¨ã€æœ‰äº‰è®®ã€æœ‰å›åº”
- **ä¸èµ°è¿‡åœº**ï¼šæ‹’ç»æµæ°´è´¦å¼å‘è¨€ï¼Œæ¯æ¬¡å‘è¨€éƒ½åº”è¯¥æ¨è¿›è®¨è®ºæ·±åº¦

### 1.2 è®¾è®¡ç†å¿µ

#### v8 çš„å±€é™æ€§
- **å›ºå®šæµçº¿é¡ºåº**ï¼šID1â†’6â†’5â†’3â†’4â†’8â†’15â†’16ï¼Œæœºæ¢°åŒ–
- **å­¤ç«‹å‘è¨€**ï¼šä¸“å®¶åªçœ‹åˆ°"æœ¬è½®å½“å‰å‘è¨€"ï¼Œç¼ºå°‘å®Œæ•´å†å²ä¸Šä¸‹æ–‡
- **æ— é€’è¿›å…³ç³»**ï¼šæ¯è½®å‘è¨€ç›¸å¯¹ç‹¬ç«‹ï¼Œç¼ºå°‘å»¶ç»­æ€§

#### v9 çš„çªç ´
1. **å¯¹è¯ä¿¡æ¯æ•°æ®åº“**ï¼šå®Œæ•´è®°å½•æ‰€æœ‰å‘è¨€+å…³é”®è§‚ç‚¹+äº‰è®®ç‚¹
2. **AI é©±åŠ¨é¡ºåº**ï¼šé¢†è¢–æ ¹æ®å¯¹è¯è¿›å±•æ™ºèƒ½å†³å®šä¸‹ä¸€ä½å‘è¨€è€…
3. **é€’è¿›å¼ä¸Šä¸‹æ–‡**ï¼šä¸“å®¶çœ‹åˆ°å®Œæ•´å†å²ï¼Œå±•ç°æ€è€ƒæ¼”è¿›
4. **äºŒæ¬¡é‚€è¯·æœºåˆ¶**ï¼šä¸“å®¶å¯å¤šæ¬¡å‘è¨€ï¼Œæ·±åŒ–äº‰è®®ç‚¹

---

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          DebateEngineï¼ˆè¾©è®ºå¼•æ“ï¼‰            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ContextDatabaseï¼ˆå¯¹è¯ä¿¡æ¯æ•°æ®åº“ï¼‰   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ speeches: []  // æ‰€æœ‰å‘è¨€è®°å½•  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ keyPoints: Map // å…³é”®è§‚ç‚¹ç´¢å¼• â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ controversies: [] // äº‰è®®ç„¦ç‚¹  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ relations: []  // å‘è¨€å…³è”     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   runRound() - å•è½®è¾©è®ºæ‰§è¡Œé€»è¾‘      â”‚  â”‚
â”‚  â”‚  1. é¢†è¢–å¼€åœº                          â”‚  â”‚
â”‚  â”‚  2. while(true) åŠ¨æ€å‘è¨€å¾ªç¯ â”â”â”â”“   â”‚  â”‚
â”‚  â”‚     - decideNextSpeaker() AIå†³ç­– â”‚   â”‚  â”‚
â”‚  â”‚     - ä¸“å®¶å‘è¨€ + è®°å½•åˆ°DB         â”‚   â”‚  â”‚
â”‚  â”‚     - åˆ¤æ–­æ˜¯å¦COMPLETE            â”‚   â”‚  â”‚
â”‚  â”‚  3. å§”æ‰˜äººç‚¹è¯„ â†â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›   â”‚  â”‚
â”‚  â”‚  4. é¢†è¢–æ€»ç»“                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   buildRoleSpeechPrompt() - æç¤ºè¯   â”‚  â”‚
â”‚  â”‚  - getRelevantContext() ä¸‰å±‚ä¸Šä¸‹æ–‡   â”‚  â”‚
â”‚  â”‚    â”œâ”€ myHistory: è‡ªå·±çš„å‘è¨€å†å²      â”‚  â”‚
â”‚  â”‚    â”œâ”€ othersKeyPoints: ä»–äººå…³é”®è§‚ç‚¹  â”‚  â”‚
â”‚  â”‚    â””â”€ allRounds: å®Œæ•´è¾©è®ºæ—¶é—´çº¿      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å…³é”®æµç¨‹å¯¹æ¯”

| æµç¨‹ç¯èŠ‚ | v8ï¼ˆæµç¨‹åŒ–ï¼‰ | v9ï¼ˆåŠ¨æ€å¯¹è¯ï¼‰ |
|---------|-------------|---------------|
| å‘è¨€é¡ºåº | å›ºå®šæµçº¿ï¼ˆ8ä¸ªå¿…é€‰è§’è‰²ï¼‰ | AIåŠ¨æ€å†³ç­–ï¼ˆå¯é‡å¤é‚€è¯·ï¼‰ |
| ä¸Šä¸‹æ–‡ | ä»…æœ¬è½®å½“å‰å‘è¨€ | ä¸‰å±‚å®Œæ•´ä¸Šä¸‹æ–‡ |
| å‘è¨€æ¬¡æ•° | æ¯äººæ¯è½®1æ¬¡ | å¯å¤šæ¬¡ï¼ˆäºŒæ¬¡é‚€è¯·ï¼‰ |
| ç»“æŸåˆ¤æ–­ | å›ºå®šè½®æ¬¡ | AIåˆ¤æ–­"COMPLETE" |
| å…³é”®ä¿¡æ¯ | æ— ç»“æ„åŒ–æå– | è‡ªåŠ¨æå–è§‚ç‚¹/æ•°æ® |

---

## 3. æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 3.1 ContextDatabaseï¼ˆå¯¹è¯ä¿¡æ¯æ•°æ®åº“ï¼‰

**æ–‡ä»¶ä½ç½®**: `debateEngine.js` è¡Œ14-175

#### 3.1.1 æ•°æ®ç»“æ„

```javascript
class ContextDatabase {
  speeches: [
    {
      id: "speech_${round}_${roleId}_${timestamp}",
      roleId: 8,
      roleName: "ç«äº‰å‹å•†",
      content: "...",
      round: 2,
      timestamp: "2025-10-03T15:30:00.000Z",
      keyPoints: [
        { type: "å»ºè®®", text: "å»ºè®®èšç„¦å·®å¼‚åŒ–..." },
        { type: "æ•°æ®", text: "å¸‚åœºä»½é¢ä¸‹é™15%..." }
      ],
      dataRefs: ["15%", "æ ¹æ®è‰¾ç‘å’¨è¯¢2024å¹´æŠ¥å‘Š"]
    }
  ],

  keyPoints: Map {
    8 => [
      { round: 1, points: [...], content: "..." },
      { round: 2, points: [...], content: "..." }
    ]
  },

  controversies: [
    { topic: "å®šä»·ç­–ç•¥æ˜¯å¦è¿‡ä½", count: 3 }
  ]
}
```

#### 3.1.2 æ ¸å¿ƒæ–¹æ³•

**1. addSpeech(speech)** - å‘è¨€å½•å…¥
- è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ID
- æå–å…³é”®è§‚ç‚¹ï¼ˆextractKeyPointsï¼‰
- æå–æ•°æ®å¼•ç”¨ï¼ˆextractDataReferencesï¼‰
- æ›´æ–°è§’è‰²è§‚ç‚¹ç´¢å¼•

**2. extractKeyPoints(content)** - å…³é”®è§‚ç‚¹æå–
```javascript
// è§„åˆ™1: æå–"å»ºè®®"ç›¸å…³å¥å­
/[å»ºè®®|æ¨è|åº”è¯¥|éœ€è¦|å¿…é¡»][^ã€‚ï¼ï¼Ÿ]*[ã€‚ï¼ï¼Ÿ]/g

// è§„åˆ™2: æå–"é—®é¢˜"ç›¸å…³å¥å­
/[é—®é¢˜|é£é™©|æŒ‘æˆ˜|æ‹…å¿ƒ|å¿§è™‘][^ã€‚ï¼ï¼Ÿ]*[ã€‚ï¼ï¼Ÿ]/g

// è§„åˆ™3: æå–"æ•°æ®"ç›¸å…³å¥å­
/[\d]+[%|ä¸‡|äº¿|å€|ä¸ª|æ¬¡|å¹´|æœˆ|å¤©][^ã€‚ï¼ï¼Ÿ]*[ã€‚ï¼ï¼Ÿ]/g
```

**3. getRelevantContext(roleId, currentRound)** - ä¸Šä¸‹æ–‡æŸ¥è¯¢
è¿”å›ä¸‰å±‚ä¸Šä¸‹æ–‡ï¼š
- `myHistory`: è¯¥è§’è‰²ä¹‹å‰çš„æ‰€æœ‰å‘è¨€
- `othersKeyPoints`: å…¶ä»–è§’è‰²çš„å…³é”®è§‚ç‚¹ï¼ˆåªå–æœ€è¿‘2è½®ï¼‰
- `allRounds`: å®Œæ•´è¾©è®ºæ—¶é—´çº¿ï¼ˆæŒ‰è½®æ¬¡ç»„ç»‡ï¼‰

#### 3.1.3 å¾…è®¨è®ºç»†èŠ‚ â“

1. **å…³é”®è§‚ç‚¹æå–è§„åˆ™**
   - å½“å‰ä½¿ç”¨ç®€å•æ­£åˆ™ï¼Œæ˜¯å¦è¶³å¤Ÿï¼Ÿ
   - æ˜¯å¦éœ€è¦å¼•å…¥ NLP æ¨¡å‹æå–æ›´å¤æ‚çš„è§‚ç‚¹ï¼Ÿ
   - å¦‚ä½•å¤„ç†è·¨å¥çš„å¤æ‚å»ºè®®ï¼Ÿ

2. **äº‰è®®ç„¦ç‚¹è¯†åˆ«**
   - å½“å‰é˜ˆå€¼ï¼šè¢«æåŠ2æ¬¡ä»¥ä¸Š
   - æ˜¯å¦éœ€è¦åŠ¨æ€è°ƒæ•´ï¼ˆå¦‚ï¼š5è½®è¾©è®ºé˜ˆå€¼2ï¼Œ10è½®é˜ˆå€¼3ï¼‰ï¼Ÿ
   - æ˜¯å¦éœ€è¦è¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…ï¼ˆè€Œéç®€å•å‰20å­—åŒ¹é…ï¼‰ï¼Ÿ

3. **æ•°æ®å¼•ç”¨éªŒè¯**
   - å½“å‰ä»…æå–ï¼Œä¸éªŒè¯çœŸå®æ€§
   - æ˜¯å¦éœ€è¦æ£€æŸ¥"æ ¹æ®XXæŠ¥å‘Š"çš„çœŸå®æ€§ï¼Ÿ
   - å¦‚ä½•é˜²æ­¢ AI ç¼–é€ æ•°æ®ï¼Ÿ

4. **æŒä¹…åŒ–éœ€æ±‚**
   - å½“å‰ä»…å†…å­˜å­˜å‚¨
   - æ˜¯å¦éœ€è¦ä¿å­˜åˆ°åç«¯/LocalStorageï¼Ÿ
   - æ˜¯å¦éœ€è¦æ”¯æŒè·¨ä¼šè¯æ¢å¤ï¼Ÿ

---

### 3.2 AI é©±åŠ¨çš„åŠ¨æ€å‘è¨€é¡ºåº

**æ–‡ä»¶ä½ç½®**: `debateEngine.js` è¡Œ808-889

#### 3.2.1 å†³ç­–æœºåˆ¶

**è¾“å…¥ä¿¡æ¯**ï¼š
- å½“å‰è¾©è®ºæƒ…å†µï¼ˆä¸»è®®é¢˜ã€è½®æ¬¡ã€æœ¬è½®ç„¦ç‚¹ï¼‰
- è¾©è®ºæ—¶é—´çº¿ï¼ˆæœ€è¿‘5æ¡è¦ç‚¹ï¼‰
- å½“å‰äº‰è®®ç„¦ç‚¹ï¼ˆè¢«å¤šæ¬¡æåŠçš„é—®é¢˜ï¼‰
- å¯é‚€è¯·ä¸“å®¶åˆ—è¡¨ï¼ˆå«æ˜¯å¦å·²å‘è¨€æ ‡è®°ï¼‰

**AI å†³ç­–æç¤ºè¯æ ¸å¿ƒ**ï¼š
```javascript
const decisionPrompt = `
**å†³ç­–è¦æ±‚**ï¼š
1. åŸºäºå½“å‰å¯¹è¯è¿›å±•å’Œäº‰è®®ç„¦ç‚¹ï¼Œé€‰æ‹©æœ€åˆé€‚çš„ä¸‹ä¸€ä½å‘è¨€ä¸“å®¶
2. å¦‚æœæŸä¸ªè¯é¢˜éœ€è¦æ·±å…¥æ¢è®¨ï¼Œå¯ä»¥é‚€è¯·å·²å‘è¨€ä¸“å®¶å†æ¬¡å›åº”
3. ä¼˜å…ˆè€ƒè™‘èƒ½æ¨è¿›å¯¹è¯æ·±åº¦ã€è§£å†³äº‰è®®ã€æä¾›æ•°æ®æ”¯æ’‘çš„ä¸“å®¶
4. å¦‚æœæœ¬è½®è®¨è®ºå·²å……åˆ†ï¼ˆæ‰€æœ‰å…³é”®è§’è‰²éƒ½å‘è¿‡è¨€ä¸”æ— æ˜æ˜¾äº‰è®®ï¼‰ï¼Œè¿”å›"COMPLETE"

è¯·ç›´æ¥å›å¤ä¸“å®¶IDï¼ˆå¦‚"3"ï¼‰æˆ–"COMPLETE"ï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–å†…å®¹ã€‚
`;
```

**Temperature æ§åˆ¶**: 0.3ï¼ˆä½æ¸©åº¦ç¡®ä¿å†³ç­–ç¨³å®šï¼‰

#### 3.2.2 äºŒæ¬¡é‚€è¯·æœºåˆ¶

```javascript
// v8: æ¯äººæ¯è½®åªèƒ½å‘è¨€1æ¬¡
const sortedRoles = this.getSortedRoles();
for (const role of sortedRoles) {
  // å‘è¨€ä¸€æ¬¡åï¼Œè¯¥è§’è‰²åœ¨æœ¬è½®ä¸å†å‘è¨€
}

// v9: æ”¯æŒäºŒæ¬¡é‚€è¯·
const alreadySpoken = []; // è®°å½•å·²å‘è¨€ï¼Œä½†å…è®¸é‡å¤
while (true) {
  const nextRole = await this.decideNextSpeaker(roundNumber, roundData, alreadySpoken);
  if (!nextRole) break; // COMPLETE
  // ä¸“å®¶å‘è¨€...
  alreadySpoken.push(nextRole.id); // å…è®¸åŒä¸€IDå¤šæ¬¡å‡ºç°
}
```

#### 3.2.3 å¾…è®¨è®ºç»†èŠ‚ â“

1. **é¢†è¢–å†³ç­–æç¤ºè¯ä¼˜åŒ–**
   - å½“å‰çº¦200 tokensï¼Œæ˜¯å¦è¶³å¤Ÿè¯¦ç»†ï¼Ÿ
   - æ˜¯å¦éœ€è¦æä¾›æ›´å¤šç¤ºä¾‹ï¼ˆå¦‚ï¼šä»€ä¹ˆæƒ…å†µä¸‹äºŒæ¬¡é‚€è¯·ï¼‰ï¼Ÿ
   - å¦‚ä½•é˜²æ­¢é¢†è¢–é™·å…¥"æ— é™é‚€è¯·åŒä¸€ä¸“å®¶"ï¼Ÿ

2. **"COMPLETE" åˆ¤æ–­æ ‡å‡†**
   - å½“å‰ä¾èµ– AI ä¸»è§‚åˆ¤æ–­
   - æ˜¯å¦éœ€è¦æ˜ç¡®è§„åˆ™ï¼ˆå¦‚ï¼šè‡³å°‘Nä¸ªä¸“å®¶å‘è¨€ï¼Œä¸”æ— æ–°äº‰è®®ï¼‰ï¼Ÿ
   - å¦‚ä½•å¹³è¡¡"å……åˆ†è®¨è®º"å’Œ"æ•ˆç‡"ï¼Ÿ

3. **äºŒæ¬¡é‚€è¯·é¢‘ç‡æ§åˆ¶**
   - å½“å‰æ— é™åˆ¶
   - æ˜¯å¦éœ€è¦é™åˆ¶å•è½®æœ€å¤§å‘è¨€æ¬¡æ•°ï¼ˆå¦‚ï¼šå•äººæœ€å¤š3æ¬¡ï¼‰ï¼Ÿ
   - æ˜¯å¦éœ€è¦é™åˆ¶æ€»å‘è¨€æ¬¡æ•°ï¼ˆå¦‚ï¼šå•è½®æœ€å¤š15æ¬¡å‘è¨€ï¼‰ï¼Ÿ

4. **å†³ç­–å¤±è´¥é™çº§**
   - å½“å‰ï¼šAIå†³ç­–å¤±è´¥ â†’ ä½¿ç”¨é»˜è®¤é¡ºåºï¼ˆcandidateRoles[0]ï¼‰
   - æ˜¯å¦éœ€è¦æ›´æ™ºèƒ½çš„é™çº§ç­–ç•¥ï¼Ÿ
   - æ˜¯å¦éœ€è¦è®°å½•å†³ç­–å¤±è´¥æ—¥å¿—ï¼Ÿ

---

### 3.3 é€’è¿›å¼å¯¹è¯ä¸Šä¸‹æ–‡ç³»ç»Ÿ

**æ–‡ä»¶ä½ç½®**: `debateEngine.js` è¡Œ906-992

#### 3.3.1 ä¸Šä¸‹æ–‡æ„å»º

**æç¤ºè¯ç»“æ„**ï¼š
```javascript
buildRoleSpeechPrompt(role, roundNumber, roundData) {
  const relevantContext = this.contextDatabase.getRelevantContext(role.id, roundNumber);

  return `${role.systemPrompt}

**å½“å‰è¾©è®ºæƒ…å†µ**ï¼š
- ä¸»è®®é¢˜ï¼š${this.state.topic}
- å½“å‰è½®æ¬¡ï¼šç¬¬ ${roundNumber}/${this.state.rounds} è½®
- æœ¬è½®ç„¦ç‚¹ï¼š${roundData.topic}

ğŸ“‹ ä½ ä¹‹å‰çš„å‘è¨€å†å²ï¼ˆ${relevantContext.myHistory.length}æ¬¡ï¼‰ï¼š
${myHistoryText}
ï¼ˆæç¤ºï¼šè¯·åœ¨æœ¬è½®å‘è¨€ä¸­å±•ç°ä¸ä¹‹å‰çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»ï¼‰

ğŸ’¡ å…¶ä»–ä¸“å®¶çš„å…³é”®è§‚ç‚¹ï¼š
${othersKeyPointsText}

ğŸ“Š å®Œæ•´è¾©è®ºæ—¶é—´çº¿ï¼ˆå…³é”®è¦ç‚¹ï¼‰ï¼š
${timelineText}

**âš ï¸ é‡è¦è¦æ±‚**ï¼š
1. åŸºäºä»¥ä¸Šå®Œæ•´å†å²ä¸Šä¸‹æ–‡ï¼Œå±•ç°ä¸ä¹‹å‰å‘è¨€çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»
2. å›åº”å…¶ä»–ä¸“å®¶çš„å…³é”®è§‚ç‚¹ï¼Œå±•ç°å¯¹è¯æ„Ÿï¼ˆè€Œéèµ°è¿‡åœºï¼‰
3. å¼•ç”¨å…·ä½“æ•°æ®/æ¡ˆä¾‹ï¼ˆä¸¥ç¦ç¼–é€ ï¼‰ï¼Œå‚è€ƒè¾©è®ºæ—¶é—´çº¿ä¸­çš„æ•°æ®å¼•ç”¨
4. ç»“åˆä½ çš„è§’è‰²å®šä½ï¼Œç»™å‡º3ä¸ªå…·ä½“å»ºè®®ï¼ˆå«æ—¶é—´/æˆæœ¬/èµ„æºï¼‰
5. æ§åˆ¶åœ¨200-300å­—
`;
}
```

#### 3.3.2 ä¸‰å±‚ä¸Šä¸‹æ–‡è¯¦è§£

**Layer 1: myHistoryï¼ˆè‡ªå·±çš„å‘è¨€å†å²ï¼‰**
- ç›®çš„ï¼šå±•ç°æ€è€ƒæ¼”è¿›
- å†…å®¹ï¼šè¯¥è§’è‰²ä¹‹å‰æ‰€æœ‰å‘è¨€ï¼ˆæœ€è¿‘3æ¬¡ï¼‰
- æç¤ºï¼šè¯·åœ¨æœ¬è½®å‘è¨€ä¸­å±•ç°ä¸ä¹‹å‰çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»

**Layer 2: othersKeyPointsï¼ˆå…¶ä»–ä¸“å®¶å…³é”®è§‚ç‚¹ï¼‰**
- ç›®çš„ï¼šä¿ƒè¿›äº’åŠ¨å›åº”
- å†…å®¹ï¼šå…¶ä»–è§’è‰²çš„å…³é”®è§‚ç‚¹ï¼ˆåªå–æœ€è¿‘2è½®ï¼‰
- æ ¼å¼ï¼š`è§’è‰²åï¼šç¬¬Xè½®è§‚ç‚¹1ï¼›è§‚ç‚¹2`

**Layer 3: allRoundsï¼ˆå®Œæ•´è¾©è®ºæ—¶é—´çº¿ï¼‰**
- ç›®çš„ï¼šå…¨å±€è§†è§’å†³ç­–
- å†…å®¹ï¼šæ‰€æœ‰è½®æ¬¡çš„å…³é”®è¦ç‚¹+æ•°æ®å¼•ç”¨
- æ ¼å¼ï¼š`ç¬¬Xè½®ï¼šè§’è‰²Aè§‚ç‚¹+æ•°æ® | è§’è‰²Bè§‚ç‚¹+æ•°æ®`

#### 3.3.3 å¾…è®¨è®ºç»†èŠ‚ â“

1. **ä¸Šä¸‹æ–‡é•¿åº¦æ§åˆ¶**
   - å½“å‰æ— é™åˆ¶ï¼Œå¯èƒ½å¯¼è‡´ token è¶…é™
   - æ˜¯å¦éœ€è¦é™åˆ¶ myHistory æœ€å¤šNæ¬¡ï¼Ÿ
   - æ˜¯å¦éœ€è¦é™åˆ¶ allRounds æœ€å¤šMè½®ï¼Ÿ
   - å¦‚ä½•åŠ¨æ€è°ƒæ•´ï¼ˆ10è½®è¾©è®º vs 3è½®è¾©è®ºï¼‰ï¼Ÿ

2. **æ™ºèƒ½å‹ç¼©å†å²**
   - å½“å‰å®Œæ•´å±•ç¤ºæ‰€æœ‰å†å²
   - æ˜¯å¦éœ€è¦åªä¿ç•™å…³é”®ä¿¡æ¯ï¼ˆkeyPoints + dataRefsï¼‰ï¼Ÿ
   - æ˜¯å¦éœ€è¦ AI æ€»ç»“å‹ç¼©å†å²ï¼Ÿ

3. **è¿è´¯æ€§ä¸ç®€æ´æ€§å¹³è¡¡**
   - å¼ºè°ƒ"é€’è¿›å…³ç³»"å¯èƒ½å¯¼è‡´å‘è¨€å†—é•¿
   - å¦‚ä½•åœ¨"æ·±åº¦é€’è¿›"å’Œ"200-300å­—"ä¹‹é—´å¹³è¡¡ï¼Ÿ
   - æ˜¯å¦éœ€è¦è°ƒæ•´æç¤ºè¯æªè¾ï¼Ÿ

4. **å›åº”æ ‡è®°**
   - å½“å‰åªè¦æ±‚"å›åº”å…¶ä»–ä¸“å®¶"ï¼Œä½†ä¸æ˜¾å¼æ ‡è®°
   - æ˜¯å¦éœ€è¦åœ¨å‘è¨€ä¸­æ ‡è®°"@è§’è‰²å"ï¼Ÿ
   - æ˜¯å¦éœ€è¦åœ¨UIä¸­å¯è§†åŒ–å›åº”å…³ç³»ï¼ˆå¦‚ï¼šç®­å¤´è¿æ¥ï¼‰ï¼Ÿ

---

### 3.4 ä¸“å®¶å‘è¨€æ ¼å¼ä¼˜åŒ–

**æ–‡ä»¶ä½ç½®**: `index.html` è¡Œ1212-1260

#### 3.4.1 æ ¼å¼åŒ–æµç¨‹

```javascript
function formatExpertSpeech(content) {
  // æ­¥éª¤1: ç§»é™¤ Markdown ç¬¦å·
  html = html.replace(/\*\*/g, '');           // ç§»é™¤ç²—ä½“
  html = html.replace(/^#{1,6}\s+/gm, '');    // ç§»é™¤æ ‡é¢˜
  html = html.replace(/^---+$/gm, '');        // ç§»é™¤åˆ†éš”çº¿
  html = html.replace(/`([^`]+)`/g, '$1');    // ç§»é™¤ä»£ç 

  // æ­¥éª¤2: å…³é”®è¯åŠ ç²—ï¼ˆ16ä¸ªå…³é”®è¯ï¼‰
  const keywords = ['å»ºè®®', 'é—®é¢˜', 'é£é™©', 'æœºä¼š', 'æ•°æ®', ...];
  keywords.forEach(keyword => {
    html = html.replace(regex, `$1<strong style="color: #007AFF; font-weight: 600;">${keyword}</strong>$2`);
  });

  // æ­¥éª¤3: æ™ºèƒ½åˆ—è¡¨æ ¼å¼åŒ–
  // "1. xxx 2. xxx" â†’ <div>1. xxx</div><div>2. xxx</div>
  html = html.replace(/(\d+)\.\s*([^ã€‚ï¼ï¼Ÿ\n]+)/g, (match, num, text) => {
    return `<div style="margin: 8px 0 8px 20px; line-height: 1.8;">
      <span style="display: inline-block; width: 24px; font-weight: 600; color: #007AFF;">${num}.</span>
      ${text.trim()}
    </div>`;
  });

  // æ­¥éª¤4: ç´§å‡‘æ˜¾ç¤ºï¼ˆç§»é™¤ç©ºè¡Œï¼‰
  const lines = html.split('\n').map(line => line.trim()).filter(line => line.length > 0);
  html = lines.map(line => {
    if (line.startsWith('<div')) return line; // åˆ—è¡¨é¡¹
    return `<p style="margin: 6px 0; line-height: 1.8; color: #333;">${line}</p>`;
  }).join('');

  return html;
}
```

#### 3.4.2 å¾…è®¨è®ºç»†èŠ‚ â“

1. **å…³é”®è¯åˆ—è¡¨å®Œæ•´æ€§**
   - å½“å‰16ä¸ªï¼šå»ºè®®ã€é—®é¢˜ã€é£é™©ã€æœºä¼šã€æ•°æ®ã€æŒ‘æˆ˜ã€ä¼˜åŠ¿ã€åŠ£åŠ¿ã€å¨èƒã€æ–¹æ¡ˆã€ç­–ç•¥ã€ç›®æ ‡ã€å…³é”®ã€æ ¸å¿ƒã€é‡ç‚¹ã€æ³¨æ„
   - æ˜¯å¦éœ€è¦å¢åŠ ï¼Ÿï¼ˆå¦‚ï¼šæ”¶ç›Šã€æˆæœ¬ã€æ—¶é—´ã€èµ„æºï¼‰
   - æ˜¯å¦éœ€è¦æ”¯æŒè‡ªå®šä¹‰ï¼Ÿ

2. **åŠ ç²—é¢œè‰²æ–¹æ¡ˆ**
   - å½“å‰å›ºå®šè“è‰² #007AFF
   - æ˜¯å¦éœ€è¦æ ¹æ®è§’è‰²å±‚çº§åŠ¨æ€å˜åŒ–ï¼Ÿ
     - æ ¸å¿ƒå±‚ï¼šè“è‰²
     - å¤–éƒ¨å±‚ï¼šç´«è‰²
     - ä»·å€¼å±‚ï¼šç»¿è‰²

3. **åˆ—è¡¨æ ¼å¼æ”¯æŒ**
   - å½“å‰æ”¯æŒï¼š`1. xxx`ã€`(1) xxx`
   - æ˜¯å¦éœ€è¦æ”¯æŒåµŒå¥—åˆ—è¡¨ï¼Ÿï¼ˆ1.1, 1.2ï¼‰
   - æ˜¯å¦éœ€è¦æ”¯æŒæ— åºåˆ—è¡¨ï¼Ÿï¼ˆ- xxxï¼‰

4. **é«˜çº§æ ¼å¼æ”¯æŒ**
   - æ˜¯å¦éœ€è¦æ”¯æŒè¡¨æ ¼ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ”¯æŒå¼•ç”¨å—ï¼Ÿ
   - æ˜¯å¦éœ€è¦æ”¯æŒé“¾æ¥ï¼Ÿ

---

## 4. å®ç°ç»†èŠ‚

### 4.1 æ–‡ä»¶å˜æ›´æ¸…å•

| æ–‡ä»¶ | å˜æ›´å†…å®¹ | è¡Œæ•° |
|-----|---------|------|
| `debateEngine.js` | æ–°å¢ ContextDatabase ç±» | 14-175 |
| `debateEngine.js` | åˆå§‹åŒ– contextDatabase | 218 |
| `debateEngine.js` | 5ä¸ªå‘è¨€å½•å…¥ç‚¹ | 607-764 |
| `debateEngine.js` | æ–°å¢ decideNextSpeaker() | 808-889 |
| `debateEngine.js` | é‡å†™ buildRoleSpeechPrompt() | 906-992 |
| `debateEngine.js` | ä¼˜åŒ–åŠ¨æ€å‘è¨€å¾ªç¯ | 660-709 |
| `index.html` | æ–°å¢ formatExpertSpeech() | 1212-1260 |
| `index.html` | åº”ç”¨æ ¼å¼åŒ–åˆ°å‘è¨€æ˜¾ç¤º | 1058 |

### 4.2 æ ¸å¿ƒä»£ç ç‰‡æ®µ

#### 4.2.1 å‘è¨€å½•å…¥ç¤ºä¾‹

```javascript
// ä½ç½®ï¼šdebateEngine.js runRound() æ–¹æ³•

// 1. é¢†è¢–å¼€åœºå‘è¨€å½•å…¥
const leaderSpeech = {
  roleId: this.facilitator.id,
  roleName: this.facilitator.shortName,
  content: leaderOpening.content || leaderOpening,
  round: roundNumber,
  timestamp: new Date().toISOString()
};
roundData.speeches.push(leaderSpeech);
this.contextDatabase.addSpeech(leaderSpeech); // âœ… [v9] å½•å…¥æ•°æ®åº“
```

#### 4.2.2 åŠ¨æ€å‘è¨€å¾ªç¯

```javascript
// ä½ç½®ï¼šdebateEngine.js runRound() æ–¹æ³•

const alreadySpoken = []; // è¿½è¸ªå·²å‘è¨€ï¼ˆå…è®¸é‡å¤ï¼‰

while (true) {
  // é¢†è¢–AIå†³ç­–ï¼šä¸‹ä¸€ä½å‘è¨€ä¸“å®¶
  const nextRole = await this.decideNextSpeaker(roundNumber, roundData, alreadySpoken);

  // å¦‚æœé¢†è¢–è®¤ä¸ºæœ¬è½®è®¨è®ºå·²å……åˆ†ï¼Œç»“æŸå‘è¨€é˜¶æ®µ
  if (!nextRole) {
    console.log(`âœ… [v9] ç¬¬ ${roundNumber} è½®ä¸“å®¶å‘è¨€é˜¶æ®µç»“æŸï¼ˆé¢†è¢–å†³å®šè®¨è®ºå·²å……åˆ†ï¼‰`);
    break;
  }

  // ä¸“å®¶å‘è¨€
  console.log(`ğŸ¤ [v9] ${nextRole.shortName} å¼€å§‹å‘è¨€...`);
  const speech = await this.callAI({
    role: nextRole,
    prompt: this.buildRoleSpeechPrompt(nextRole, roundNumber, roundData),
    temperature: 0.6,
    maxTokens: 400
  });

  const roleSpeech = {
    roleId: nextRole.id,
    roleName: nextRole.shortName,
    content: speech.content || speech,
    color: nextRole.color,
    layer: nextRole.layer,
    round: roundNumber,
    timestamp: new Date().toISOString()
  };

  roundData.speeches.push(roleSpeech);
  this.contextDatabase.addSpeech(roleSpeech); // âœ… [v9] å½•å…¥æ•°æ®åº“

  this.emit('roleSpeak', {
    round: roundNumber,
    role: nextRole,
    content: speech.content || speech
  });

  // è®°å½•å·²å‘è¨€ï¼ˆå…è®¸åŒä¸€ä¸“å®¶å¤šæ¬¡å‘è¨€ï¼‰
  alreadySpoken.push(nextRole.id);

  await this.delay(500); // æ¨¡æ‹ŸçœŸå®è¾©è®ºèŠ‚å¥
}
```

#### 4.2.3 é€’è¿›å¼ä¸Šä¸‹æ–‡æ„å»º

```javascript
// ä½ç½®ï¼šdebateEngine.js buildRoleSpeechPrompt() æ–¹æ³•

const relevantContext = this.contextDatabase.getRelevantContext(role.id, roundNumber);

// æ„å»ºä½ çš„å‘è¨€å†å²
let myHistoryText = '';
if (relevantContext.myHistory && relevantContext.myHistory.length > 0) {
  myHistoryText = `\n**ğŸ“‹ ä½ ä¹‹å‰çš„å‘è¨€å†å²ï¼ˆ${relevantContext.myHistory.length}æ¬¡ï¼‰**ï¼š\n`;
  relevantContext.myHistory.slice(-3).forEach(speech => {
    myHistoryText += `- ç¬¬${speech.round}è½®ï¼š${speech.content.substring(0, 100)}...\n`;
  });
  myHistoryText += `ï¼ˆæç¤ºï¼šè¯·åœ¨æœ¬è½®å‘è¨€ä¸­å±•ç°ä¸ä¹‹å‰çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»ï¼‰\n`;
}

// æ„å»ºå…¶ä»–ä¸“å®¶å…³é”®è§‚ç‚¹
let othersKeyPointsText = '';
if (relevantContext.othersKeyPoints && relevantContext.othersKeyPoints.length > 0) {
  othersKeyPointsText = `\n**ğŸ’¡ å…¶ä»–ä¸“å®¶çš„å…³é”®è§‚ç‚¹**ï¼š\n`;
  relevantContext.othersKeyPoints.forEach(({ roleId, recentPoints }) => {
    const roleName = this.roles.find(r => r.id === roleId)?.shortName || `è§’è‰²${roleId}`;
    if (recentPoints && recentPoints.length > 0) {
      const pointsText = recentPoints.map(p => {
        const pointsSummary = p.points.map(pt => pt.text).join('ï¼›');
        return `ç¬¬${p.round}è½®ï¼š${pointsSummary}`;
      }).join(' | ');
      othersKeyPointsText += `- ${roleName}ï¼š${pointsText}\n`;
    }
  });
}

// æ„å»ºå®Œæ•´æ—¶é—´çº¿
let timelineText = '';
if (Object.keys(relevantContext.allRounds).length > 0) {
  timelineText = `\n**ğŸ“Š å®Œæ•´è¾©è®ºæ—¶é—´çº¿ï¼ˆå…³é”®è¦ç‚¹ï¼‰**ï¼š\n`;
  Object.entries(relevantContext.allRounds).forEach(([round, speeches]) => {
    const roundKeyPoints = speeches
      .map(s => {
        const keyPointsText = s.keyPoints.map(p => p.text).slice(0, 2).join('ï¼›');
        const dataText = s.dataRefs.length > 0 ? ` [æ•°æ®ï¼š${s.dataRefs.slice(0, 2).join('ã€')}]` : '';
        return `${s.roleName}ï¼š${keyPointsText}${dataText}`;
      })
      .join(' | ');
    timelineText += `- ç¬¬${round}è½®ï¼š${roundKeyPoints}\n`;
  });
}

return `${role.systemPrompt}

**å½“å‰è¾©è®ºæƒ…å†µ**ï¼š
- ä¸»è®®é¢˜ï¼š${this.state.topic}
- å½“å‰è½®æ¬¡ï¼šç¬¬ ${roundNumber}/${this.state.rounds} è½®
- æœ¬è½®ç„¦ç‚¹ï¼š${roundData.topic}
${myHistoryText}
${othersKeyPointsText}
${timelineText}

**âš ï¸ é‡è¦è¦æ±‚**ï¼š
1. åŸºäºä»¥ä¸Šå®Œæ•´å†å²ä¸Šä¸‹æ–‡ï¼Œå±•ç°ä¸ä¹‹å‰å‘è¨€çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»
2. å›åº”å…¶ä»–ä¸“å®¶çš„å…³é”®è§‚ç‚¹ï¼Œå±•ç°å¯¹è¯æ„Ÿï¼ˆè€Œéèµ°è¿‡åœºï¼‰
3. å¼•ç”¨å…·ä½“æ•°æ®/æ¡ˆä¾‹ï¼ˆä¸¥ç¦ç¼–é€ ï¼‰ï¼Œå‚è€ƒè¾©è®ºæ—¶é—´çº¿ä¸­çš„æ•°æ®å¼•ç”¨
4. ç»“åˆä½ çš„è§’è‰²å®šä½ï¼Œç»™å‡º3ä¸ªå…·ä½“å»ºè®®ï¼ˆå«æ—¶é—´/æˆæœ¬/èµ„æºï¼‰
5. æ§åˆ¶åœ¨200-300å­—

ç°åœ¨ï¼Œè¯·åŸºäºä½ çš„è§’è‰²å®šä½å’Œå®Œæ•´å†å²ä¸Šä¸‹æ–‡ï¼Œå‘è¡¨æœ¬è½®æ„è§ã€‚`;
```

#### 4.2.4 ä¸“å®¶å‘è¨€å­—æ•°ä¼˜åŒ–å®ç°

**å®æ–½æ—¶é—´**: 2025-10

**éœ€æ±‚æ¥æº**: ç”¨æˆ·éœ€æ±‚ (Section 5.2, line 619)
```markdown
- â“ å¦‚ä½•åœ¨"æ·±åº¦é€’è¿›"å’Œ"200-300å­—"ä¹‹é—´å¹³è¡¡ï¼Ÿ>>300å­—å¤ªå°‘äº†, 500?
```

**å®æ–½æ–¹æ¡ˆ**: ä¸‰æ­¥éª¤ç³»ç»Ÿçº§åŒæ­¥æ›´æ–°

**æ­¥éª¤1: æç¤ºè¯æ–‡æœ¬æ›´æ–°** (`debateEngine.js` è¡Œ1144)
- ä½ç½®: `buildRoleSpeechPrompt()` æ–¹æ³•
- å˜æ›´: "æ§åˆ¶åœ¨200-300å­—" â†’ "æ§åˆ¶åœ¨500å­—"
- å½±å“: æ‰€æœ‰åŠ¨æ€ç”Ÿæˆçš„ä¸“å®¶å‘è¨€æç¤ºè¯

```javascript
// ä½ç½®ï¼šdebateEngine.js buildRoleSpeechPrompt() æ–¹æ³•

**âš ï¸ é‡è¦è¦æ±‚**ï¼š
1. åŸºäºä»¥ä¸Šå®Œæ•´å†å²ä¸Šä¸‹æ–‡ï¼Œå±•ç°ä¸ä¹‹å‰å‘è¨€çš„è¿è´¯æ€§å’Œé€’è¿›å…³ç³»
2. å›åº”å…¶ä»–ä¸“å®¶çš„å…³é”®è§‚ç‚¹ï¼Œå±•ç°å¯¹è¯æ„Ÿï¼ˆè€Œéèµ°è¿‡åœºï¼‰
3. å¼•ç”¨å…·ä½“æ•°æ®/æ¡ˆä¾‹ï¼ˆä¸¥ç¦ç¼–é€ ï¼‰ï¼Œå‚è€ƒè¾©è®ºæ—¶é—´çº¿ä¸­çš„æ•°æ®å¼•ç”¨
4. ç»“åˆä½ çš„è§’è‰²å®šä½ï¼Œç»™å‡º3ä¸ªå…·ä½“å»ºè®®ï¼ˆå«æ—¶é—´/æˆæœ¬/èµ„æºï¼‰
5. æ§åˆ¶åœ¨500å­—  // â† ä» "200-300å­—" æ›´æ–°ä¸º "500å­—"

ç°åœ¨ï¼Œè¯·åŸºäºä½ çš„è§’è‰²å®šä½å’Œå®Œæ•´å†å²ä¸Šä¸‹æ–‡ï¼Œå‘è¡¨æœ¬è½®æ„è§ã€‚
```

**æ­¥éª¤2: è§’è‰²é…ç½®æ›´æ–°** (`roles.js`)
- èŒƒå›´: å…¨éƒ¨15ä¸ªä¸“å®¶è§’è‰² systemPrompt
- ç»Ÿä¸€æ ¼å¼: "å‘è¨€æ§åˆ¶åœ¨500å­—ï¼ŒåŒ…å«è‡³å°‘Xä¸ªæ•°æ®ç¤ºä¾‹å’ŒYä¸ªå»ºè®®"
- å½±å“: ç¡®ä¿æ‰€æœ‰è§’è‰²è¡Œä¸ºæŒ‡ä»¤ä¸€è‡´

```javascript
// ç¤ºä¾‹ï¼šç¬¬ä¸€æ€§åŸåˆ™è§’è‰² (roles.js)

{
  id: 1,
  key: 'first_principle',
  systemPrompt: `ä½ ä½¿ç”¨ç¬¬ä¸€æ€§åŸç†æ€è€ƒæ–¹æ³•...

  **å»ºè®®è¦æ±‚**ï¼š
  - æä¾›3ä¸ªè¡ŒåŠ¨åŸåˆ™ï¼ˆé’ˆå¯¹ç”¨æˆ·å¹´é¾„æ®µå’Œè¡Œä¸šèƒŒæ™¯ï¼‰
  - ç”¨æ•°æ®/æ¡ˆä¾‹æ”¯æ’‘æœ¬è´¨åˆ†æï¼ˆå¦‚ï¼š"æ ¹æ®XXè¡Œä¸šæŠ¥å‘Š..."ï¼‰
  - ä¼˜å…ˆéªŒè¯å‡è®¾ï¼Œå»ºè®®å°æ­¥å¿«è·‘çš„å…·ä½“è·¯å¾„
  - æ¯ä¸ªå»ºè®®éœ€å¯é‡åŒ–æˆ–æœ‰æ˜ç¡®æ—¶é—´èŠ‚ç‚¹

  è¯·ç”¨æ¸…æ™°çš„é€»è¾‘é“¾æ¡å±•ç¤ºä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚å‘è¨€æ§åˆ¶åœ¨500å­—ï¼ŒåŒ…å«è‡³å°‘1ä¸ªæ•°æ®ç¤ºä¾‹å’Œ3ä¸ªå»ºè®®ã€‚`
}
```

**æ­¥éª¤3: APIå‚æ•°æ›´æ–°** (`debateEngine.js` è¡Œ1384)
- ä½ç½®: `callAI()` æ–¹æ³•é»˜è®¤å‚æ•°
- å˜æ›´: `maxTokens = 500` â†’ `maxTokens = 650`
- è®¡ç®—ä¾æ®: 500æ±‰å­— Ã— 1.3 token/å­— = 650 tokens
- å½±å“: ç¡®ä¿AI APIæœ‰è¶³å¤Ÿtokené¢„ç®—ï¼Œé˜²æ­¢å“åº”æˆªæ–­

```javascript
// ä½ç½®ï¼šdebateEngine.js callAI() æ–¹æ³•

async callAI({ role, prompt, temperature = 0.7, maxTokens = 650 }) {
  // ä» maxTokens = 500 å¢åŠ åˆ° 650
  // è®¡ç®—ï¼š500æ±‰å­— Ã— 1.3 token/å­— = 650 tokens
  const requestBody = {
    model: this.config.model,
    prompt: prompt,
    systemPrompt: role.systemPrompt,
    roleName: role.name,
    temperature: temperature,
    maxTokens: maxTokens
  };
  // ... rest of method
}
```

**æŠ€æœ¯åŸç†**:
ä¸­æ–‡å­—ç¬¦ä¸tokenæ¯”ä¾‹çº¦ä¸º1:1.3ï¼Œå› æ­¤500å­—éœ€è¦650 tokensæ‰èƒ½ä¿è¯å®Œæ•´è¾“å‡ºã€‚

**å®æ–½æ•ˆæœ**:
- âœ… ä¸“å®¶å‘è¨€æ·±åº¦æ˜¾è‘—æå‡ï¼ˆ200-300å­— â†’ 500å­—ï¼‰
- âœ… ä¸‰å±‚ä¸€è‡´æ€§ï¼šæç¤ºè¯ç”Ÿæˆé€»è¾‘ + è§’è‰²é…ç½® + APIå‚æ•°
- âœ… æ— å“åº”æˆªæ–­é—®é¢˜
- âœ… ä¿æŒå¯¹è¯é€’è¿›æ€§å’Œä¸“ä¸šæ€§

---

## 5. å¾…è®¨è®ºä¸ç¡®å®šçš„ç»†èŠ‚

### 5.1 æ¶æ„å±‚é¢

#### ğŸ”´ P0 - å¿…é¡»ç¡®å®š

1. **ç‰ˆæœ¬å®šä½**
   - â“ v9 æ˜¯å¦ä½œä¸ºç‹¬ç«‹å¤§ç‰ˆæœ¬å‘å¸ƒï¼Ÿ>>æ˜¯
   - â“ æ˜¯å¦éœ€è¦ä¿ç•™ v8 æµç¨‹æ¨¡å¼ä½œä¸º"ç»å…¸æ¨¡å¼"ï¼Ÿ >>å¯ä¿ç•™, ä½†å¯èƒ½æ„ä¹‰ä¸å¤§-å®ç”¨æ€§ä½
   - â“ ç”¨æˆ·æ˜¯å¦å¯ä»¥åœ¨ UI ä¸­åˆ‡æ¢ v8/v9 æ¨¡å¼ï¼Ÿ>>å¿…è¦æ€§ä½, ä¿ç•™ä¸€ç‰ˆè€Œå·²

2. **ContextDatabase æŒä¹…åŒ–**
   - â“ æ˜¯å¦éœ€è¦ä¿å­˜åˆ°åç«¯/LocalStorageï¼Ÿ>>æ˜¯!!!
   - â“ æ˜¯å¦éœ€è¦æ”¯æŒè·¨ä¼šè¯æ¢å¤ï¼ˆå¦‚ï¼šå§”æ‰˜äººå…³é—­æµè§ˆå™¨åç»§ç»­ï¼‰ï¼Ÿ>>ä¸­æœŸè§„åˆ’
   - â“ æ•°æ®å­˜å‚¨æ ¼å¼ï¼Ÿï¼ˆJSON / SQLite / MongoDBï¼‰>>ä¸ç†Ÿæ‚‰, å»ºè®®? é€šç”¨æ€§å¼ºæ ‡æ³¨?

3. **Token æˆæœ¬æ§åˆ¶**
   - â“ å½“å‰æ— é™åˆ¶ï¼Œ10è½®è¾©è®ºå¯èƒ½è¶…è¿‡5000 tokens >>ç›®å‰çœ‹è¿˜å¥½, 
   - â“ å¦‚ä½•å‹ç¼©ä¸Šä¸‹æ–‡ï¼Ÿï¼ˆåªä¿ç•™å…³é”®ä¿¡æ¯ / AIæ€»ç»“å‹ç¼©ï¼‰>>ä¸­æœŸè§„åˆ’
   - â“ æ˜¯å¦éœ€è¦æ˜¾ç¤ºå®æ—¶ token æ¶ˆè€—ï¼Ÿ>>å¯ä»¥

#### ğŸŸ  P1 - é‡è¦ä½†éç´§æ€¥

4. **å…³é”®è§‚ç‚¹æå–ä¼˜åŒ–**
   - â“ å½“å‰æ­£åˆ™åŒ¹é…æ˜¯å¦è¶³å¤Ÿï¼Ÿ>>ä¸å¤ªç†è§£, è¯´ç™½è¯
   - â“ æ˜¯å¦éœ€è¦å¼•å…¥ NLP æ¨¡å‹ï¼ˆå¦‚ï¼šBERT/GPTï¼‰ï¼Ÿ>>éœ€è¦, é‡ç‚¹æ˜¯æ–¹æ¡ˆ, æˆæœ¬?
   - â“ å¦‚ä½•å¤„ç†è·¨å¥çš„å¤æ‚è§‚ç‚¹ï¼Ÿ>> ä¸ç¡®å®š

5. **äº‰è®®ç„¦ç‚¹è¯†åˆ«ä¼˜åŒ–**
   - â“ é˜ˆå€¼æ˜¯å¦éœ€è¦åŠ¨æ€è°ƒæ•´ï¼Ÿ>>å»ºè®®? å¦‚æœæ˜¯ä¸€è½®é‡Œå•ä¸ªä¸“å®¶çš„æœ€å¤šå‘è¨€æ¬¡æ•°, æœ€å¤š3æ¬¡
   - â“ æ˜¯å¦éœ€è¦è¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…ï¼Ÿ >>åº”è¯¥è¦å§
   - â“ å¦‚ä½•é¿å…è¯¯åˆ¤ï¼ˆå¦‚ï¼šè¡¨è¿°ç›¸åŒä½†ç«‹åœºä¸åŒï¼‰ï¼Ÿ >>1. é¢†è¢–ä»£ç†å†³æ–­, å¦‚éœ€è¦, è¯·å§”æ‰˜äººå†³æ–­

6. **æ•°æ®å¼•ç”¨éªŒè¯**
   - â“ å¦‚ä½•é˜²æ­¢ AI ç¼–é€ æ•°æ®ï¼Ÿ>>é‡è¦!!! å»AIåŒ–, æ¸©åº¦å€¼æ§åˆ¶?
   - â“ æ˜¯å¦éœ€è¦æ£€æŸ¥"æ ¹æ®XXæŠ¥å‘Š"çš„çœŸå®æ€§ï¼Ÿ >>å¿…é¡»!
   - â“ æ˜¯å¦éœ€è¦æä¾›æ•°æ®æ¥æºé“¾æ¥ï¼Ÿ>>åŸåˆ™ä¸Šä¸éœ€è¦, ä½†ç¡®å®æœ€åé€‚å½“ç»™å‡ºå‡ºå¤„

### 5.2 äº¤äº’å±‚é¢

#### ğŸ”´ P0 - å¿…é¡»ç¡®å®š

7. **é¢†è¢–å†³ç­–è§„åˆ™**
   - â“ "COMPLETE" åˆ¤æ–­æ ‡å‡†æ˜¯å¦éœ€è¦æ˜ç¡®è§„åˆ™ï¼Ÿ>> è¿™é‡Œçš„competeæ˜¯æŒ‡ä»€ä¹ˆ>
   - â“ æ˜¯å¦éœ€è¦é™åˆ¶å•è½®æœ€å¤§å‘è¨€æ¬¡æ•°ï¼Ÿ>>å•ä¸“å®¶(é¢†è¢–ä½œä¸ºfacilitatoré™¤å¤–)æœ€å¤š3æ¬¡(åŒ…æ‹¬ä¸»åŠ¨/è¢«åŠ¨-è¢«é‚€è¯·)å‘è¨€; æ‰€æœ‰äººä¸­æµ‹è¯•ä¸åº”è¶…è¿‡20æ¬¡(æš‚å®š)
   - â“ å¦‚ä½•å¹³è¡¡"å……åˆ†è®¨è®º"å’Œ"æ•ˆç‡"ï¼Ÿ>>å‰å‡ è½®, é¢†è¢–å¯ä»¥å’Œå§”æ‰˜äººç¡®è®¤ä¸€ä¸‹'èŠ‚å¥æŠŠæ¡'å’Œæ„Ÿå—åŠå»ºè®®

8. **äºŒæ¬¡é‚€è¯·æ§åˆ¶**
   - â“ æ˜¯å¦éœ€è¦é™åˆ¶å•äººæœ€å¤šå‘è¨€æ¬¡æ•°ï¼ˆå¦‚ï¼š3æ¬¡ï¼‰ï¼Ÿ>>å•ä¸“å®¶(é¢†è¢–ä½œä¸ºfacilitatoré™¤å¤–)æœ€å¤š3æ¬¡(åŒ…æ‹¬ä¸»åŠ¨/è¢«åŠ¨-è¢«é‚€è¯·)å‘è¨€
   - â“ å¦‚ä½•é˜²æ­¢é¢†è¢–é™·å…¥"æ— é™é‚€è¯·åŒä¸€ä¸“å®¶"ï¼Ÿ>>æ§åˆ¶æœ€å¤š3æ¬¡, é™¤éå§”æ‰˜äººè¦æ±‚
   - â“ æ˜¯å¦éœ€è¦å‘ç”¨æˆ·æç¤º"XXä¸“å®¶å·²ç¬¬Næ¬¡å‘è¨€"ï¼Ÿ>>ä¸ç”¨, é¢†è¢–ç®¡ç†å’Œæ§åˆ¶

#### ğŸŸ  P1 - é‡è¦ä½†éç´§æ€¥

9. **ä¸Šä¸‹æ–‡é•¿åº¦æ§åˆ¶**
   - â“ myHistory æ˜¯å¦éœ€è¦é™åˆ¶æœ€å¤šNæ¬¡ï¼Ÿ>> ä¸ç†è§£é—®é¢˜
   - â“ allRounds æ˜¯å¦éœ€è¦é™åˆ¶æœ€å¤šMè½®ï¼Ÿ>>é»˜è®¤10è½®, è¶…è¿‡20è½®è¦ä»˜è´¹æ¨¡å¼äº†(ä¸­/åæœŸè§„åˆ’)
   - â“ å¦‚ä½•åŠ¨æ€è°ƒæ•´ï¼ˆ10è½® vs 3è½®è¾©è®ºï¼‰ï¼Ÿ>>å¯èƒ½3è½®å°±æ²¡å¿…è¦, è‡³å°‘5è½®, æ­£å¸¸20è½®ä¸Šé™; æˆ‘ä»¬è‡ªå·±å¼€å‘æµ‹è¯•æ— ä¸Šé™(æœ€åä¸€è½®, å§”æ‰˜äººè¦æ±‚ä¸‹, å¯ä»¥å»¶ç»­)

10. **è¿è´¯æ€§ä¸ç®€æ´æ€§å¹³è¡¡**
    - â“ å¦‚ä½•åœ¨"æ·±åº¦é€’è¿›"å’Œ"200-300å­—"ä¹‹é—´å¹³è¡¡ï¼Ÿ>>300å­—å¤ªå°‘äº†, 500?
    - â“ æç¤ºè¯æªè¾æ˜¯å¦éœ€è¦è°ƒæ•´ï¼Ÿ >> å¿…é¡»çš„, ä»¥å®é™…ç°å®ä¸ºå‡†, ä½“ç°ä¸“å®¶ä¸“ä¸šæ€§å’Œå°±é—®é¢˜å’Œè®¨è®ºçš„ç›¸å…³æ€§, ä¿è¯æ·±åº¦å’Œè½å®å®æ•ˆæ€§
    - â“ æ˜¯å¦éœ€è¦åˆ†"æ·±åº¦æ¨¡å¼"å’Œ"å¿«é€Ÿæ¨¡å¼"ï¼Ÿ>>å¯ä»¥, ä¸­æœŸè§„åˆ’

### 5.3 å±•ç¤ºå±‚é¢

#### ğŸŸ¡ P2 - å¯é€‰ä¼˜åŒ–

11. **æ ¼å¼åŒ–å¢å¼º**
    - â“ å…³é”®è¯åˆ—è¡¨æ˜¯å¦éœ€è¦æ‰©å±•ï¼Ÿ>>éœ€è¦
    - â“ åŠ ç²—é¢œè‰²æ˜¯å¦éœ€è¦æ ¹æ®è§’è‰²å±‚çº§åŠ¨æ€å˜åŒ–ï¼Ÿ >>å¯ä»¥, ä»¥ä½“éªŒä¸ºæ ‡å‡†! åœ¨æ²¡æœ‰è¯­éŸ³åŠŸèƒ½å‰, çœ‹å­—å¿…é¡»æä¾›reader-care
    - â“ æ˜¯å¦éœ€è¦æ”¯æŒåµŒå¥—åˆ—è¡¨ã€è¡¨æ ¼ã€å¼•ç”¨ï¼Ÿ>>good idea, ä½†å…·ä½“è¦çœ‹å®æ•ˆ

12. **å›åº”å…³ç³»å¯è§†åŒ–**
    - â“ æ˜¯å¦éœ€è¦åœ¨å‘è¨€ä¸­æ ‡è®°"@è§’è‰²å"ï¼Ÿ>> å¯èƒ½æ¨¡æ‹Ÿç°åœºæ„Ÿ, è¦ç»™æ¯ä¸ªä¸“å®¶éƒ½èµ·ä¸ªåå­—, åŒ…æ‹¬å¤´åƒ; ä»¥ååæœŸè§„åˆ’è¿˜è¦è€ƒè™‘æ¨¡æ‹Ÿè§†é¢‘ä¼šè®®æ„Ÿè§‰
    - â“ æ˜¯å¦éœ€è¦åœ¨UIä¸­å¯è§†åŒ–å›åº”å…³ç³»ï¼ˆç®­å¤´è¿æ¥ï¼‰ï¼Ÿ>>å¯ä»¥è€ƒè™‘, çœ‹å…·ä½“æ•ˆæœ
    - â“ æ˜¯å¦éœ€è¦"äº‰è®®ç„¦ç‚¹"çƒ­åŠ›å›¾ï¼Ÿ>> éœ€è¦, è¿™æ˜¯ä½œä¸ºæŠ¥å‘Šçš„ä¸€éƒ¨åˆ†

13. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
    - â“ æ˜¯å¦éœ€è¦æ˜¾ç¤º"é¢†è¢–æ­£åœ¨å†³ç­–ä¸‹ä¸€ä½å‘è¨€è€…..."åŠ è½½çŠ¶æ€ï¼Ÿ>>ä¸åº”è¯¥å§, æ˜¾å¾—è¿Ÿé’>
    - â“ æ˜¯å¦éœ€è¦æ˜¾ç¤º"å·²å‘è¨€ä¸“å®¶"åˆ—è¡¨ï¼Ÿ>> æ„Ÿè§‰ä¸ç”¨
    - â“ æ˜¯å¦éœ€è¦æ”¯æŒç”¨æˆ·æ‰‹åŠ¨ä»‹å…¥ï¼ˆå¦‚ï¼šå¼ºåˆ¶é‚€è¯·æŸä¸“å®¶ï¼‰ï¼Ÿ>>å¿…é¡»æœ‰

---

## 6. æµ‹è¯•éªŒè¯è®¡åˆ’

### 6.1 æµ‹è¯•åœºæ™¯

æ ¹æ® TODO #097ï¼Œéœ€è¦æµ‹è¯•3ä¸ªåœºæ™¯ï¼š

#### åœºæ™¯1ï¼šRRXS è‡ªåª’ä½“å•†ä¸šåŒ–
- **è®®é¢˜**: "æˆ‘åº”è¯¥å¦‚ä½•ä»èŒåœºè½¬å‹åšè‡ªåª’ä½“ï¼Ÿ"
- **å…³é”®éªŒè¯**:
  - å¯¹è¯å»¶ç»­æ€§ï¼šä¸“å®¶æ˜¯å¦å¼•ç”¨è‡ªå·±ä¹‹å‰çš„è§‚ç‚¹
  - äº’åŠ¨å›åº”ï¼šä¸“å®¶æ˜¯å¦å›åº”å…¶ä»–ä¸“å®¶çš„å»ºè®®
  - åŠ¨æ€é¡ºåºï¼šé¢†è¢–æ˜¯å¦é‚€è¯·æœ€åˆé€‚çš„ä¸“å®¶
  - äºŒæ¬¡é‚€è¯·ï¼šæ˜¯å¦å‡ºç°åŒä¸€ä¸“å®¶å¤šæ¬¡å‘è¨€çš„æƒ…å†µ
  - äº‰è®®è¯†åˆ«ï¼šæ˜¯å¦è¯†åˆ«å‡ºå…³é”®äº‰è®®ç‚¹ï¼ˆå¦‚ï¼šå®šä»·ã€å®šä½ï¼‰

#### åœºæ™¯2ï¼šç”µå•†åˆ›ä¸šå†³ç­–
- **è®®é¢˜**: "æˆ‘åº”è¯¥åœ¨æ·˜å®è¿˜æ˜¯æŠ–éŸ³å¼€åº—ï¼Ÿ"
- **å…³é”®éªŒè¯**:
  - æ•°æ®å¼•ç”¨ï¼šä¸“å®¶æ˜¯å¦æä¾›å…·ä½“æ•°æ®æ”¯æ’‘
  - æ ¼å¼ä¼˜åŒ–ï¼šåˆ—è¡¨æ˜¯å¦æ­£ç¡®åˆ†è¡Œï¼Œå…³é”®è¯æ˜¯å¦åŠ ç²—
  - ä¸Šä¸‹æ–‡å®Œæ•´ï¼šä¸“å®¶æ˜¯å¦çœ‹åˆ°å®Œæ•´è¾©è®ºå†å²
  - COMPLETEåˆ¤æ–­ï¼šé¢†è¢–æ˜¯å¦åœ¨é€‚å½“æ—¶æœºç»“æŸè®¨è®º

#### åœºæ™¯3ï¼šä¸ªäººæˆé•¿è§„åˆ’
- **è®®é¢˜**: "40å²å¦‚ä½•å®ç°èŒä¸šçªç ´ï¼Ÿ"
- **å…³é”®éªŒè¯**:
  - é€’è¿›å…³ç³»ï¼šä¸“å®¶åç»­å‘è¨€æ˜¯å¦æ·±åŒ–å‰é¢çš„è§‚ç‚¹
  - Tokenæ§åˆ¶ï¼š10è½®è¾©è®ºæ˜¯å¦è¶…è¿‡é¢„æœŸtokenæ•°
  - æ€§èƒ½è¡¨ç°ï¼šAIå†³ç­–è€—æ—¶æ˜¯å¦åœ¨å¯æ¥å—èŒƒå›´

### 6.2 éªŒè¯æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | éªŒè¯æ–¹æ³• |
|-----|--------|---------|
| å¯¹è¯å»¶ç»­æ€§ | â‰¥80% ä¸“å®¶å‘è¨€å¼•ç”¨è‡ªå·±å†å² | äººå·¥æ£€æŸ¥å‘è¨€å†…å®¹ |
| äº’åŠ¨å›åº”ç‡ | â‰¥60% ä¸“å®¶å›åº”å…¶ä»–è§‚ç‚¹ | æ£€æŸ¥æ˜¯å¦æåŠå…¶ä»–è§’è‰² |
| åŠ¨æ€å†³ç­–åˆç†æ€§ | â‰¥90% å†³ç­–ç¬¦åˆå¯¹è¯é€»è¾‘ | äººå·¥åˆ¤æ–­é‚€è¯·æ˜¯å¦åˆç† |
| äºŒæ¬¡é‚€è¯·è§¦å‘ç‡ | 10-30% è½®æ¬¡å‡ºç°äºŒæ¬¡é‚€è¯· | ç»Ÿè®¡ alreadySpoken æ•°æ® |
| äº‰è®®è¯†åˆ«å‡†ç¡®ç‡ | â‰¥70% äº‰è®®ç‚¹è¢«æ­£ç¡®è¯†åˆ« | å¯¹æ¯”äººå·¥æ ‡æ³¨ vs AIè¯†åˆ« |
| æ•°æ®å¼•ç”¨ç‡ | â‰¥80% å‘è¨€åŒ…å«æ•°æ® | æ£€æŸ¥ dataRefs å­—æ®µ |
| æ ¼å¼æ­£ç¡®ç‡ | 100% åˆ—è¡¨æ­£ç¡®åˆ†è¡Œ | UI æ£€æŸ¥ |
| Token æ€»æ¶ˆè€— | â‰¤8000 tokens/10è½® | åç«¯ç»Ÿè®¡ |
| AIå†³ç­–è€—æ—¶ | â‰¤3ç§’/æ¬¡ | æ€§èƒ½ç›‘æ§ |

### 6.3 æµ‹è¯•æ‰§è¡Œæ­¥éª¤

1. **ç¯å¢ƒå‡†å¤‡**
   - å¯åŠ¨åç«¯æœåŠ¡ï¼ˆç«¯å£3000ï¼‰
   - å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆç«¯å£8080ï¼‰
   - ç¡®è®¤ DeepSeek API å¯ç”¨

2. **æ‰§è¡Œæµ‹è¯•**
   - ä¾æ¬¡æµ‹è¯•3ä¸ªåœºæ™¯ï¼ˆæ¯ä¸ª5è½®ï¼‰
   - è®°å½•æ‰€æœ‰å‘è¨€åˆ°æµ‹è¯•æ—¥å¿—
   - æˆªå›¾ä¿å­˜å…³é”®ç•Œé¢

3. **æ•°æ®æ”¶é›†**
   - å¯¼å‡º ContextDatabase æ•°æ®ï¼ˆspeeches, keyPoints, controversiesï¼‰
   - ç»Ÿè®¡ token æ¶ˆè€—
   - è®°å½•æ€§èƒ½æ•°æ®

4. **é—®é¢˜è®°å½•**
   - è®°å½•æ‰€æœ‰ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸º
   - åˆ†ç±»ï¼šP0ä¸¥é‡/P1é‡è¦/P2ä¼˜åŒ–
   - æå‡ºä¿®å¤æ–¹æ¡ˆ

---

## 7. ä¸ v8 çš„å¯¹æ¯”

### 7.1 æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨

| ç»´åº¦ | v8ï¼ˆæµç¨‹åŒ–ï¼‰ | v9ï¼ˆåŠ¨æ€å¯¹è¯ï¼‰ | æå‡ç‚¹ |
|-----|-------------|---------------|--------|
| **å®šä½** | è§’è‰²æç¤ºè¯æ‰“ç£¨ + æ•°æ®åŒ– | AIé©±åŠ¨çš„çœŸå®å¯¹è¯ç³»ç»Ÿ | ä»"å†…å®¹ä¼˜åŒ–"åˆ°"ç³»ç»Ÿé‡æ„" |
| **å‘è¨€é¡ºåº** | å›ºå®šæµçº¿ï¼ˆ8ä¸ªå¿…é€‰ï¼‰ | AIåŠ¨æ€å†³ç­–ï¼ˆå¯é‡å¤é‚€è¯·ï¼‰ | âœ… çµæ´»æ€§ã€çœŸå®æ€§ |
| **ä¸Šä¸‹æ–‡** | ä»…æœ¬è½®å½“å‰å‘è¨€ï¼ˆ~200å­—ï¼‰ | ä¸‰å±‚å®Œæ•´ä¸Šä¸‹æ–‡ï¼ˆ~1500å­—ï¼‰ | âœ… æ·±åº¦ã€å»¶ç»­æ€§ |
| **å‘è¨€æ¬¡æ•°** | æ¯äººæ¯è½®1æ¬¡ | å¯å¤šæ¬¡ï¼ˆäºŒæ¬¡é‚€è¯·ï¼‰ | âœ… æ·±åŒ–äº‰è®®ç‚¹ |
| **ç»“æŸåˆ¤æ–­** | å›ºå®šè½®æ¬¡ | AIåˆ¤æ–­"COMPLETE" | âœ… æ™ºèƒ½åŒ– |
| **ä¿¡æ¯æå–** | æ—  | è‡ªåŠ¨æå–è§‚ç‚¹/æ•°æ® | âœ… ç»“æ„åŒ–ã€å¯è¿½æº¯ |
| **æ ¼å¼ä¼˜åŒ–** | Markdownä¿ç•™ | æ™ºèƒ½æ ¼å¼åŒ– | âœ… å¯è¯»æ€§ |
| **Tokenæˆæœ¬** | ~3000/10è½® | ~5000/10è½®ï¼ˆé¢„ä¼°ï¼‰ | âš ï¸ æˆæœ¬å¢åŠ 67% |
| **å¼€å‘å¤æ‚åº¦** | ä¸­ç­‰ | é«˜ | âš ï¸ ç»´æŠ¤æˆæœ¬å¢åŠ  |

### 7.2 ç”¨æˆ·ä½“éªŒæå‡

#### v8 çš„é—®é¢˜ï¼ˆç”¨æˆ·åé¦ˆï¼‰
1. "æ„Ÿè§‰ä¸“å®¶åœ¨èµ°è¿‡åœºï¼Œå‘è¨€ç›¸å¯¹ç‹¬ç«‹"
2. "çœ‹ä¸å‡ºè§’è‰²ä¹‹é—´çš„äº’åŠ¨å’Œäº‰è®®"
3. "æ¯è½®å‘è¨€éƒ½å¾ˆæµ…ï¼Œç¼ºå°‘æ·±åº¦é€’è¿›"

#### v9 çš„æ”¹è¿›
1. âœ… **å»¶ç»­æ€§**ï¼šä¸“å®¶å‘è¨€æ˜ç¡®å¼•ç”¨è‡ªå·±çš„å†å²è§‚ç‚¹
2. âœ… **äº’åŠ¨æ€§**ï¼šä¸“å®¶å›åº”å…¶ä»–ä¸“å®¶çš„å»ºè®®ï¼Œå½¢æˆå¯¹è¯
3. âœ… **æ·±åº¦**ï¼šäºŒæ¬¡é‚€è¯·æœºåˆ¶å…è®¸æ·±åŒ–äº‰è®®ç‚¹

### 7.3 æŠ€æœ¯å€ºåŠ¡

#### v9 æ–°å¢çš„æŠ€æœ¯æŒ‘æˆ˜
1. **Token ç®¡ç†**ï¼šä¸Šä¸‹æ–‡é•¿åº¦æ— é™åˆ¶ï¼Œå¯èƒ½è¶…é™
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šAIå†³ç­–å¢åŠ å“åº”æ—¶é—´
3. **æ•°æ®ä¸€è‡´æ€§**ï¼šContextDatabase éœ€è¦ç»´æŠ¤å®Œæ•´æ€§
4. **é”™è¯¯å¤„ç†**ï¼šAIå†³ç­–å¤±è´¥éœ€è¦é™çº§ç­–ç•¥

#### å¾…è§£å†³çš„é—ç•™é—®é¢˜
1. v8 çš„å›ºå®šæµçº¿æ¨¡å¼æ˜¯å¦ä¿ç•™ä¸º"ç»å…¸æ¨¡å¼"ï¼Ÿ
2. å¦‚ä½•å‘ç”¨æˆ·è§£é‡Š v9 çš„"åŠ¨æ€å¯¹è¯"ä¼˜åŠ¿ï¼Ÿ
3. æ˜¯å¦éœ€è¦æä¾›"v8 vs v9"å¯¹æ¯”æµ‹è¯•ï¼Ÿ

---

## 8. ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’

### 8.1 ç«‹å³è¡ŒåŠ¨ï¼ˆæœ¬å‘¨ï¼‰

1. **è®¨è®ºå¹¶ç¡®å®šå¾…å®šç»†èŠ‚**ï¼ˆæœ¬æ–‡æ¡£ç¬¬5èŠ‚ï¼‰
   - ä¼˜å…ˆè®¨è®ºæ‰€æœ‰ P0 é—®é¢˜ï¼ˆ7ä¸ªï¼‰
   - å½¢æˆæ˜ç¡®çš„è®¾è®¡å†³ç­–æ–‡æ¡£

2. **æ‰§è¡Œæµ‹è¯•éªŒè¯**ï¼ˆTODO #097ï¼‰
   - 3ä¸ªåœºæ™¯å®Œæ•´æµ‹è¯•
   - æ”¶é›†éªŒè¯æ•°æ®
   - è®°å½•é—®é¢˜æ¸…å•

3. **æ–‡æ¡£å®Œå–„**
   - æ›´æ–° progress.mdï¼ˆv9 é‡Œç¨‹ç¢‘ï¼‰
   - æ›´æ–° CLAUDE.mdï¼ˆv9 ç« èŠ‚ï¼‰
   - åˆ›å»ºæµ‹è¯•æŠ¥å‘Š

### 8.2 çŸ­æœŸä¼˜åŒ–ï¼ˆæœªæ¥2å‘¨ï¼‰

1. **æ€§èƒ½ä¼˜åŒ–**
   - Token å‹ç¼©ç­–ç•¥
   - AIå†³ç­–è€—æ—¶ä¼˜åŒ–
   - ä¸Šä¸‹æ–‡æ™ºèƒ½è£å‰ª

2. **ç”¨æˆ·ä½“éªŒ**
   - åŠ è½½çŠ¶æ€æç¤º
   - å‘è¨€ä¸“å®¶åˆ—è¡¨
   - äº‰è®®ç„¦ç‚¹å¯è§†åŒ–

3. **ä»£ç é‡æ„**
   - ContextDatabase å•å…ƒæµ‹è¯•
   - é”™è¯¯å¤„ç†å¢å¼º
   - æ—¥å¿—ç³»ç»Ÿå®Œå–„

### 8.3 é•¿æœŸè§„åˆ’ï¼ˆæœªæ¥1ä¸ªæœˆï¼‰

1. **é«˜çº§åŠŸèƒ½**
   - NLP æ¨¡å‹é›†æˆï¼ˆè§‚ç‚¹æå–ï¼‰
   - è¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…ï¼ˆäº‰è®®è¯†åˆ«ï¼‰
   - æ•°æ®æ¥æºéªŒè¯ï¼ˆé˜²æ­¢ç¼–é€ ï¼‰

2. **æ¨¡å¼æ‰©å±•**
   - v8 ç»å…¸æ¨¡å¼ä¿ç•™
   - v9 æ·±åº¦æ¨¡å¼
   - v10 å¿«é€Ÿæ¨¡å¼ï¼ˆ3è½®æç®€ï¼‰

3. **ç”Ÿæ€å»ºè®¾**
   - è¾©è®ºæ¨¡æ¿åº“
   - ç”¨æˆ·åé¦ˆæ”¶é›†
   - æ•°æ®åˆ†ææŠ¥å‘Š

---

## 9. é™„å½•

### 9.1 å…³é”®æ–‡ä»¶å¿«é€Ÿå®šä½

- **æ ¸å¿ƒæ¶æ„**: `debateEngine.js` è¡Œ14-175ï¼ˆContextDatabaseï¼‰
- **åŠ¨æ€å†³ç­–**: `debateEngine.js` è¡Œ808-889ï¼ˆdecideNextSpeakerï¼‰
- **ä¸Šä¸‹æ–‡æ„å»º**: `debateEngine.js` è¡Œ906-992ï¼ˆbuildRoleSpeechPromptï¼‰
- **æ ¼å¼ä¼˜åŒ–**: `index.html` è¡Œ1212-1260ï¼ˆformatExpertSpeechï¼‰
- **å‘è¨€å½•å…¥**: `debateEngine.js` è¡Œ607-764ï¼ˆ5ä¸ªå½•å…¥ç‚¹ï¼‰

### 9.2 è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹å®Œæ•´ä¸Šä¸‹æ–‡**ï¼š
```javascript
console.log('[DEBUG] relevantContext:', JSON.stringify(relevantContext, null, 2));
```

2. **ç›‘æ§AIå†³ç­–**ï¼š
```javascript
console.log('[DEBUG] Leader decision:', decisionText, '| Candidates:', candidateRoles.map(r => r.id));
```

3. **éªŒè¯å…³é”®è§‚ç‚¹æå–**ï¼š
```javascript
console.log('[DEBUG] Extracted keyPoints:', speech.keyPoints);
console.log('[DEBUG] Extracted dataRefs:', speech.dataRefs);
```

### 9.3 æœ¯è¯­è¡¨

- **ContextDatabase**: å¯¹è¯ä¿¡æ¯æ•°æ®åº“ï¼Œå­˜å‚¨æ‰€æœ‰å‘è¨€+å…ƒæ•°æ®
- **keyPoints**: å…³é”®è§‚ç‚¹ï¼ŒåŒ…æ‹¬å»ºè®®ã€é—®é¢˜ã€æ•°æ®
- **dataRefs**: æ•°æ®å¼•ç”¨ï¼ŒåŒ…æ‹¬ç™¾åˆ†æ¯”ã€æ•°å­—ã€æ¥æº
- **controversies**: äº‰è®®ç„¦ç‚¹ï¼Œè¢«å¤šæ¬¡æåŠçš„é—®é¢˜
- **äºŒæ¬¡é‚€è¯·**: åŒä¸€ä¸“å®¶åœ¨åŒä¸€è½®å¤šæ¬¡å‘è¨€
- **COMPLETE**: é¢†è¢–åˆ¤æ–­æœ¬è½®è®¨è®ºå·²å……åˆ†çš„æ ‡è®°
- **é€’è¿›å…³ç³»**: ä¸“å®¶åç»­å‘è¨€ä¸ä¹‹å‰è§‚ç‚¹çš„è¿è´¯æ€§
- **ä¸‰å±‚ä¸Šä¸‹æ–‡**: myHistory + othersKeyPoints + allRounds

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-03 23:55
**ç»´æŠ¤è€…**: RRXS Team
**å®¡æ ¸çŠ¶æ€**: å¾…ç”¨æˆ·ç¡®è®¤æ‰€æœ‰å¾…å®šç»†èŠ‚ï¼ˆç¬¬5èŠ‚ï¼‰
