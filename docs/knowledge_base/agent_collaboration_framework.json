{
  "version": "1.0",
  "title": "Agentåä½œæ¡†æ¶ - å®Œæ•´æ¶æ„è®¾è®¡",
  "timestamp": "2025-11-06T06:10:00+08:00",
  "core_concept": "progress-recorder + retrieval + reasoningä¸‰ä¸ªAgentçš„æ— ç¼åä½œ",

  "architecture_layers": {
    "layer1_communication": {
      "name": "é€šä¿¡å±‚",
      "current_state": "åŒæ­¥å‡½æ•°è°ƒç”¨ï¼ˆè€¦åˆåº¦é«˜ï¼‰",
      "target_state": "å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆè§£è€¦ï¼‰",
      "implementation": {
        "short_term": {
          "method": "PowerShellå·¥ä½œæµ + JSONæ–‡ä»¶é˜Ÿåˆ—",
          "files": [
            "queue/agent_messages.json",
            "queue/task_queue.json",
            "queue/execution_results.json"
          ],
          "workflow": "Agent A â†’ å†™å…¥é˜Ÿåˆ— â†’ Agent Bè½®è¯¢ â†’ æ‰§è¡Œ â†’ è¿”å›ç»“æœ"
        },
        "medium_term": {
          "method": "Redisæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæˆ–æœ¬åœ°ZeroMQï¼‰",
          "advantages": [
            "åŸå­æ€§æ¶ˆæ¯ä¼ é€’",
            "è‡ªåŠ¨é‡è¯•æœºåˆ¶",
            "æ¶ˆæ¯æŒä¹…åŒ–"
          ]
        }
      }
    },

    "layer2_orchestration": {
      "name": "ç¼–æ’å±‚",
      "purpose": "åè°ƒå¤šä¸ªAgentçš„æ‰§è¡Œé¡ºåºå’Œä¾èµ–å…³ç³»",
      "components": {
        "workflow_engine": {
          "description": "å®šä¹‰Agentæ‰§è¡Œæµç¨‹ï¼ˆDAG - æœ‰å‘æ— ç¯å›¾ï¼‰",
          "example_workflow": {
            "trigger": "ç”¨æˆ·è¾“å…¥é—®é¢˜",
            "step1": "progress-recorderè®°å½•é—®é¢˜",
            "step2": "retrieval_agentæŸ¥è¯¢çŸ¥è¯†åº“ï¼ˆä¾èµ–step1ï¼‰",
            "step3": "reasoning_agentæ¨ç†æ–¹æ¡ˆï¼ˆä¾èµ–step2ï¼‰",
            "step4": "progress-recorderè®°å½•ç»“æœï¼ˆä¾èµ–step3ï¼‰"
          },
          "implementation": "workflow.jsoné…ç½®æ–‡ä»¶"
        },
        "task_scheduler": {
          "description": "è°ƒåº¦é•¿æœŸè¿è¡Œçš„Agentä»»åŠ¡",
          "schedule_example": {
            "every_hour": "ç¾éš¾é¢„é˜²Agentæ£€æŸ¥",
            "every_day": "ç«¯å£å†²çªæ£€æŸ¥",
            "every_week_monday": "çŸ¥è¯†åº“æå–ä¸ä¼˜åŒ–",
            "every_month": "è¿›åŒ–æŠ¥å‘Šç”Ÿæˆ"
          }
        }
      }
    },

    "layer3_service_registry": {
      "name": "æœåŠ¡æ³¨å†Œå±‚",
      "purpose": "åŠ¨æ€ç®¡ç†Agentæ³¨å†Œå’Œå‘ç°",
      "components": {
        "agent_registry": {
          "format": "registry.json",
          "structure": {
            "agent_id": "unique_identifier",
            "name": "progress-recorder",
            "type": "record_keeping",
            "version": "1.0.0",
            "endpoints": [">>record", ">>archive", ">>wrap-up"],
            "capabilities": ["create_records", "update_progress", "backup"],
            "dependencies": [],
            "status": "active"
          }
        },
        "service_discovery": {
          "method": "Agentå¯åŠ¨æ—¶è‡ªæ³¨å†Œ",
          "heartbeat": "æ¯5åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡Agentå¥åº·çŠ¶æ€"
        }
      }
    },

    "layer4_error_handling": {
      "name": "é”™è¯¯å¤„ç†å±‚",
      "mechanisms": {
        "circuit_breaker": {
          "description": "Agentæ•…éšœè‡ªåŠ¨éš”ç¦»",
          "example": {
            "scenario": "retrieval_agentè¿ç»­3æ¬¡å¤±è´¥",
            "action": "æ ‡è®°ä¸º'failure_mode'ï¼Œè‡ªåŠ¨å°è¯•å¤‡é€‰æ–¹æ¡ˆ",
            "fallback": "reasoning_agentä½¿ç”¨ç¼“å­˜çŸ¥è¯†åº“"
          }
        },
        "retry_logic": {
          "exponential_backoff": "1s â†’ 2s â†’ 4s â†’ 8sï¼ˆæœ€å¤š3æ¬¡é‡è¯•ï¼‰",
          "idempotency": "ç¡®ä¿é‡è¯•ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨"
        },
        "logging_and_monitoring": {
          "structured_logs": "JSONæ ¼å¼æ—¥å¿—ä¾¿äºåˆ†æ",
          "metrics": "æˆåŠŸç‡/å¤±è´¥ç‡/å¹³å‡å“åº”æ—¶é—´"
        }
      }
    }
  },

  "agent_contracts": {
    "progress_recorder_agent": {
      "interface": {
        "input": {
          "type": "object",
          "properties": {
            "command": {"type": "string", "enum": [">>record", ">>archive", ">>wrap-up"]},
            "data": {"type": "object"},
            "metadata": {"type": "object"}
          }
        },
        "output": {
          "type": "object",
          "properties": {
            "status": {"type": "string", "enum": ["success", "failure"]},
            "record_id": {"type": "string"},
            "timestamp": {"type": "string"},
            "message": {"type": "string"}
          }
        }
      },
      "responsibilities": [
        "è®°å½•å†³ç­–åˆ°progress.md",
        "ç®¡ç†å¤‡ä»½ç‰ˆæœ¬",
        "åŒæ­¥CLAUDE.mdï¼ˆä¸‰å±‚åŒæ­¥ï¼‰",
        "ç”Ÿæˆå¯¹è¯æ—¥å¿—"
      ],
      "expected_response_time": "<5s"
    },

    "retrieval_agent": {
      "interface": {
        "input": {
          "properties": {
            "query": {"type": "string"},
            "mode": {"type": "string", "enum": ["keyword", "pattern", "similarity", "all"]},
            "filters": {"type": "object"}
          }
        },
        "output": {
          "properties": {
            "results": {"type": "array"},
            "confidence": {"type": "number", "minimum": 0, "maximum": 1},
            "search_time_ms": {"type": "number"}
          }
        }
      },
      "responsibilities": [
        "ä»çŸ¥è¯†åº“æ£€ç´¢ç›¸å…³çŸ¥è¯†",
        "æ”¯æŒå¤šç§æœç´¢æ¨¡å¼",
        "è¿”å›å¸¦ç½®ä¿¡åº¦çš„ç»“æœ",
        "è®°å½•æœç´¢ç»Ÿè®¡ï¼ˆç”¨äºä¼˜åŒ–ï¼‰"
      ],
      "expected_response_time": "<1s",
      "accuracy_target": "95%+"
    },

    "reasoning_agent": {
      "interface": {
        "input": {
          "properties": {
            "problem": {"type": "string"},
            "context": {"type": "object"},
            "severity": {"type": "string", "enum": ["P0", "P1", "P2"]},
            "known_solutions": {"type": "array"}
          }
        },
        "output": {
          "properties": {
            "recommendation": {"type": "string"},
            "task_class": {"type": "string", "enum": ["A", "B", "C"]},
            "reasoning_steps": {"type": "array"},
            "confidence": {"type": "number"}
          }
        }
      },
      "responsibilities": [
        "åŸºäºçŸ¥è¯†åº“æ¨ç†è§£å†³æ–¹æ¡ˆ",
        "è¿›è¡ŒRCCMæ·±åº¦åˆ†æ",
        "åˆ†ç±»A/B/Cä»»åŠ¡",
        "è§£é‡Šæ¨ç†è¿‡ç¨‹"
      ],
      "expected_response_time": "<3s"
    }
  },

  "collaboration_examples": {
    "example1_problem_solving": {
      "trigger": "ç”¨æˆ·è¾“å…¥é—®é¢˜ï¼š'å¦‚ä½•é˜²æ­¢NULæ–‡ä»¶å¢é•¿'",
      "workflow": [
        {
          "step": 1,
          "agent": "progress-recorder",
          "action": "è®°å½•é—®é¢˜åˆ°progress.md TODOåŒºå—",
          "output": "task_id: TASK-001"
        },
        {
          "step": 2,
          "agent": "retrieval",
          "action": "æœç´¢'NULæ–‡ä»¶'å…³é”®è¯",
          "output": [
            "D-102: NULæ–‡ä»¶ç¾éš¾",
            "D-107: æ‰¹å¤„ç†è§„èŒƒ",
            "SOL-FS-001: è§£å†³æ–¹æ¡ˆ"
          ]
        },
        {
          "step": 3,
          "agent": "reasoning",
          "action": "åŸºäºæ£€ç´¢ç»“æœæ¨ç†",
          "output": {
            "solution": "ç¦ç”¨ > nulï¼Œä½¿ç”¨ 2>CON",
            "task_class": "Aç±»ï¼ˆå¯è‡ªä¸»æ‰§è¡Œï¼‰"
          }
        },
        {
          "step": 4,
          "agent": "progress-recorder",
          "action": "è®°å½•è§£å†³æ–¹æ¡ˆåˆ°DecisionsåŒºå—",
          "output": "decision_id: D-XXX"
        }
      ]
    },

    "example2_system_maintenance": {
      "trigger": "æ¯å‘¨ä¸€00:00 (å®šæ—¶ä»»åŠ¡)",
      "workflow": [
        {
          "parallel_tasks": [
            {
              "agent": "extraction",
              "action": "ä»progress.mdæå–æ–°å†³ç­–"
            },
            {
              "agent": "disaster_prevention",
              "action": "æ£€æŸ¥NULæ–‡ä»¶ã€é…ç½®å¤§å°"
            }
          ]
        },
        {
          "agent": "optimization",
          "action": "åŸºäºæ‰§è¡Œç»“æœä¼˜åŒ–çŸ¥è¯†åº“",
          "depends_on": "extractionå®Œæˆ"
        },
        {
          "agent": "progress-recorder",
          "action": "ç”Ÿæˆevolution_report",
          "depends_on": "optimizationå®Œæˆ"
        }
      ]
    }
  },

  "implementation_roadmap": {
    "phase1_foundation": {
      "timeline": "1-2å‘¨",
      "tasks": [
        "å®šä¹‰Agentæ¥å£å¥‘çº¦ï¼ˆJSON Schemaï¼‰",
        "å®ç°åŸºç¡€æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆJSONæ–‡ä»¶ç‰ˆï¼‰",
        "ä¸ºæ¯ä¸ªAgentæ·»åŠ å¥‘çº¦éªŒè¯"
      ]
    },
    "phase2_orchestration": {
      "timeline": "2-3å‘¨",
      "tasks": [
        "å®ç°å·¥ä½œæµå¼•æ“ï¼ˆDAGæ”¯æŒï¼‰",
        "å®ç°ä»»åŠ¡è°ƒåº¦å™¨",
        "å®ç°Agentæ³¨å†Œä¸­å¿ƒ"
      ]
    },
    "phase3_resilience": {
      "timeline": "3-4å‘¨",
      "tasks": [
        "å®ç°æ–­è·¯å™¨æ¨¡å¼",
        "å®ç°é‡è¯•å’Œè¶…æ—¶æœºåˆ¶",
        "å»ºç«‹ç›‘æ§å’Œå‘Šè­¦"
      ]
    },
    "phase4_optimization": {
      "timeline": "æŒç»­è¿›è¡Œ",
      "tasks": [
        "ä»æ‰§è¡Œå†å²å­¦ä¹ ï¼ˆå¼ºåŒ–å­¦ä¹ ï¼‰",
        "åŠ¨æ€è°ƒæ•´Agentæƒé‡",
        "æ€§èƒ½åŸºå‡†æµ‹è¯•"
      ]
    }
  },

  "benefits": {
    "immediate": [
      "âœ… Agenté—´æ¾è€¦åˆï¼ˆä¾¿äºç‹¬ç«‹æµ‹è¯•å’Œéƒ¨ç½²ï¼‰",
      "âœ… æ¸…æ™°çš„è´£ä»»è¾¹ç•Œï¼ˆæ¯ä¸ªAgentä¸€ä¸ªèŒè´£ï¼‰",
      "âœ… æ˜“äºæ–°å¢Agentï¼ˆåªéœ€å®ç°æ¥å£å¥‘çº¦ï¼‰"
    ],
    "medium_term": [
      "ğŸš€ å®Œæ•´çš„å·¥ä½œæµç¼–æ’ï¼ˆå¤æ‚ä¸šåŠ¡æµè‡ªåŠ¨åŒ–ï¼‰",
      "ğŸš€ è‡ªåŠ¨å®¹é”™å’Œæ¢å¤ï¼ˆæå‡ç³»ç»Ÿå¯é æ€§ï¼‰",
      "ğŸš€ æ€§èƒ½ä¼˜åŒ–ç©ºé—´ï¼ˆå¹¶è¡Œæ‰§è¡Œã€ç¼“å­˜ï¼‰"
    ],
    "long_term": [
      "ğŸŒŸ æ™ºèƒ½åŒ–è‡ªæˆ‘è¿›åŒ–ï¼ˆåŸºäºæ•°æ®é©±åŠ¨å†³ç­–ï¼‰",
      "ğŸŒŸ å¯æ‰©å±•æ€§ï¼ˆä»7ä¸ªAgentæ‰©å±•åˆ°70ä¸ªï¼‰",
      "ğŸŒŸ å¯è§†åŒ–ç®¡ç†ï¼ˆå›¾å½¢åŒ–å·¥ä½œæµç¼–è¾‘å™¨ï¼‰"
    ]
  }
}
